#!/bin/bash

# Prevent infinite recursion by checking if we're already in this wrapper
if [ "$JAVA_WRAPPER_RUNNING" = "1" ]; then
    echo "Error: Detected recursive call to java wrapper!" >&2
    exit 1
fi

export JAVA_WRAPPER_RUNNING=1

# Check if Java is available in the PATH
java_bin=$(command -v java 2>/dev/null)

# Ensure we don't call this wrapper itself
if [ $? -eq 0 ] && [ "$java_bin" != "$0" ]; then
    exec "$java_bin" "$@"
else
    # Fallback to junest Java
    exec "$HOME/dotfiles/bin/junest" -- java "$@"
fi
